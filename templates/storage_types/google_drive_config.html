<!-- Google Drive配置字段 -->
<div id="google_drive_fields" class="config-fields" style="display: none;">
    <div class="config-info-box warning mb-3">
        <i class="bi bi-exclamation-triangle me-2"></i>
        <strong>Google Drive配置</strong> - 需要OAuth2授权或服务账户凭据
    </div>

    <!-- 授权方式选择 -->
    <div class="mb-3">
        <label class="form-label">授权方式</label>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="drive_auth_type" id="drive_oauth" value="oauth" checked>
            <label class="form-check-label" for="drive_oauth">
                OAuth2授权（推荐）
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="drive_auth_type" id="drive_service_account" value="service_account">
            <label class="form-check-label" for="drive_service_account">
                服务账户
            </label>
        </div>
    </div>

    <!-- OAuth2配置 -->
    <div id="drive_oauth_config">
        <div class="row">
            <div class="col-md-6">
                <div class="mb-3">
                    <label for="drive_client_id" class="form-label">Client ID</label>
                    <input type="text" class="form-control" id="drive_client_id" name="client_id"
                           placeholder="留空使用默认值">
                    <div class="form-text">Google OAuth2 Client ID，留空使用rclone默认值</div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="mb-3">
                    <label for="drive_client_secret" class="form-label">Client Secret</label>
                    <input type="password" class="form-control" id="drive_client_secret" name="client_secret"
                           placeholder="留空使用默认值">
                    <div class="form-text">Google OAuth2 Client Secret，留空使用rclone默认值</div>
                </div>
            </div>
        </div>
    </div>

    <!-- 服务账户配置 -->
    <div id="drive_service_account_config" style="display: none;">
        <div class="mb-3">
            <label for="drive_service_account_file" class="form-label">服务账户文件路径 *</label>
            <input type="text" class="form-control" id="drive_service_account_file" name="service_account_file"
                   placeholder="例如：/path/to/service-account.json">
            <div class="form-text">Google服务账户JSON文件的完整路径</div>
        </div>
    </div>

    <!-- 权限范围 -->
    <div class="mb-3">
        <label for="drive_scope" class="form-label">权限范围</label>
        <select class="form-select" id="drive_scope" name="scope">
            <option value="drive">完整访问权限</option>
            <option value="drive.file">仅访问rclone创建的文件</option>
            <option value="drive.readonly">只读权限</option>
        </select>
        <div class="form-text">选择Google Drive的访问权限范围</div>
    </div>

    <div class="config-info-box info mt-3">
        <i class="bi bi-info-circle me-2"></i>
        <strong>OAuth2授权说明：</strong>
        <ul class="mb-0 mt-2">
            <li>首次配置时需要通过浏览器完成OAuth2授权</li>
            <li>可以使用rclone默认的Client ID和Secret</li>
            <li>也可以在Google Cloud Console创建自己的OAuth2应用</li>
        </ul>
    </div>

    <div class="config-info-box warning mt-3">
        <i class="bi bi-exclamation-triangle me-2"></i>
        <strong>服务账户说明：</strong>
        <ul class="mb-0 mt-2">
            <li>需要在Google Cloud Console创建服务账户</li>
            <li>下载服务账户的JSON密钥文件</li>
            <li>将文件上传到服务器并提供完整路径</li>
        </ul>
    </div>
</div>

<script>
// Google Drive授权方式切换
document.addEventListener('DOMContentLoaded', function() {
    const oauthRadio = document.getElementById('drive_oauth');
    const serviceAccountRadio = document.getElementById('drive_service_account');
    const oauthConfig = document.getElementById('drive_oauth_config');
    const serviceAccountConfig = document.getElementById('drive_service_account_config');
    
    function toggleAuthConfig() {
        if (oauthRadio && oauthRadio.checked) {
            oauthConfig.style.display = 'block';
            serviceAccountConfig.style.display = 'none';
        } else if (serviceAccountRadio && serviceAccountRadio.checked) {
            oauthConfig.style.display = 'none';
            serviceAccountConfig.style.display = 'block';
        }
    }
    
    if (oauthRadio) oauthRadio.addEventListener('change', toggleAuthConfig);
    if (serviceAccountRadio) serviceAccountRadio.addEventListener('change', toggleAuthConfig);
    
    // 初始化显示状态
    toggleAuthConfig();
});
</script>
